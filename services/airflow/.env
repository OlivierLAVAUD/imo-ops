# =============================================
# AIRFLOW CONFIGURATION - DÉVELOPPEMENT
# =============================================

# Airflow Identity
AIRFLOW_UID=50000
AIRFLOW_PROJ_DIR=./services/airflow
AIRFLOW_IMAGE_NAME=apache/airflow:2.7.3

# Airflow Database Users
AIRFLOW_USER=airflow
AIRFLOW_PASSWORD=airflow
AIRFLOW_DB_NAME=airflow

# Airflow Init
_AIRFLOW_WWW_USER_USERNAME=admin
_AIRFLOW_WWW_USER_PASSWORD=admin

# Airflow Core Configuration
AIRFLOW__CORE__EXECUTOR=CeleryExecutor
AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION='true'
AIRFLOW__CORE__LOAD_EXAMPLES='false'
AIRFLOW__CORE__ENABLE_XCOM_PICKLING='true'

# Database Configuration
AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=postgresql+psycopg2://airflow:airflow@postgres:5432/airflow
AIRFLOW__CELERY__RESULT_BACKEND=db+postgresql://airflow:airflow@postgres:5432/airflow

# Redis Broker
AIRFLOW__CELERY__BROKER_URL=redis://:@redis:6379/0

# Localisation française
AIRFLOW__WEBSERVER__WEB_UI_LANGUAGE_FEATURE=True
AIRFLOW__WEBSERVER__DEFAULT_UI_LANGUAGE=fr
AIRFLOW__CORE__DEFAULT_TIMEZONE=Europe/Paris
AIRFLOW__CORE__TIMEZONE=Europe/Paris
TZ=Europe/Paris

# Webserver Configuration
AIRFLOW__WEBSERVER__EXPOSE_CONFIG=true
AIRFLOW__WEBSERVER__RBAC=false
AIRFLOW__API__AUTH_BACKENDS=airflow.api.auth.backend.basic_auth,airflow.api.auth.backend.session

# Scheduler Configuration
AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK=true
AIRFLOW__SCHEDULER__MIN_FILE_PROCESS_INTERVAL=30

# Logging
AIRFLOW__LOGGING__LOGGING_LEVEL=INFO
AIRFLOW__LOGGING__COLORED_CONSOLE_LOG=true

# Security (Développement uniquement)
AIRFLOW__CORE__FERNET_KEY=''
_AIRFLOW_DB_UPGRADE='true'
_AIRFLOW_WWW_USER_CREATE='true'

# DAGs Configuration
AIRFLOW__CORE__DAGBAG_IMPORT_TIMEOUT=300
AIRFLOW__CORE__DAG_FILE_PROCESSOR_TIMEOUT=50

# Parallelism
AIRFLOW__CORE__PARALLELISM=32
AIRFLOW__CORE__DAG_CONCURRENCY=16
AIRFLOW__CORE__MAX_ACTIVE_RUNS_PER_DAG=16
AIRFLOW__CELERY__WORKER_CONCURRENCY=16


# Paths
DATA_DIR=./data
LOGS_DIR=./logs
BACKUP_DIR=./backups

# Additional Requirements
_PIP_ADDITIONAL_REQUIREMENTS=''

# =============================================
# POSTGRESQL CONFIGURATION (SPÉCIFIQUE AIRFLOW)
# =============================================

# PostgreSQL Airflow
POSTGRES_USER=airflow
POSTGRES_PASSWORD=airflow
POSTGRES_DB=airflow
POSTGRES_MULTIPLE_DATABASES=imo_db,airflow_db
POSTGRES_PORT=5432

# PgAdmin
PGADMIN_DEFAULT_EMAIL=admin@airflow.example.com
PGADMIN_DEFAULT_PASSWORD=admin

# =============================================
# CONNEXIONS AUX BASES DE DONNÉES
# =============================================

# PostgreSQL - imo_db
IMO_USER=imo_user
IMO_PASSWORD=password
IMO_DB=imo_db
IMO_URL=postgresql://imo_user:password@postgres:5432/imo_db

# Connexions Airflow
AIRFLOW_CONN_IMO_DB=postgresql://imo_user:password@postgres:5432/imo_db
AIRFLOW_CONN_AIRFLOW_DB=postgresql://airflow:airflow@postgres:5432/airflow

# =============================================
# DÉVELOPPEMENT & TESTING
# =============================================

# Debug mode
AIRFLOW__DEBUG__FAIL_FAST=true

# Testing
AIRFLOW_TEST_MODE=true
_AIRFLOW_DB_MIGRATE='true'

# Performance (développement)
AIRFLOW__SCHEDULER__STATS_D_ENABLED=false
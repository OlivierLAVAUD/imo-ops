{
  "mapping_fields": {
    "reference": "reference",
    "titre": "titre",
    "prix": {
      "valeur": "prix.valeur",
      "devise": "prix.devise",
      "au_m2": "prix.au_m2"
    },
    "surface": {
      "valeur": "surface.valeur",
      "unite": "surface.unite"
    },
    "composition": {
      "pieces": "composition.pieces",
      "chambres": "composition.chambres",
      "type_bien": "composition.type_bien"
    },
    "localisation": {
      "ville": "localisation.ville",
      "code_postal": "localisation.code_postal"
    },
    "description": "description",
    "caracteristiques": "caracteristiques",
    "batiment": {
      "annee_construction": "batiment.annee_construction",
      "age_bien": "batiment.age_bien",
      "ascenseur": "batiment.ascenseur"
    },
    "diagnostics": {
      "dpe": {
        "classe": "diagnostics.dpe.classe",
        "score": "diagnostics.dpe.score"
      },
      "ges": {
        "classe": "diagnostics.ges.classe",
        "score": "diagnostics.ges.score"
      }
    },
    "copropriete": {
      "charges": "copropriete.charges",
      "procedures_en_cours": "copropriete.procedures_en_cours"
    },
    "medias": {
      "images": "medias.images",
      "nombre_photos": "medias.nombre_photos",
      "has_video": "medias.has_video",
      "has_visite_virtuelle": "medias.has_visite_virtuelle",
      "has_photo": "medias.has_photo"
    },
    "contact": {
      "conseiller": "contact.conseiller",
      "telephone": "contact.telephone",
      "photo": "contact.photo",
      "lien": "contact.lien"
    },
    "url_annonce": "url_annonce",
    "metadata": {
      "date_extraction": "metadata.date_extraction",
      "score_qualite": "metadata.score_qualite",
      "etapes_traitees": "metadata.etapes_traitees"
    },
    "aggregats": {
      "performance": {
        "prix_m2": "aggregats.performance.prix_m2",
        "loyer_estime_mensuel": "aggregats.performance.loyer_estime_mensuel",
        "rendement_annuel_estime": "aggregats.performance.rendement_annuel_estime"
      },
      "scores": {
        "emplacement": "aggregats.scores.emplacement",
        "modernite": "aggregats.scores.modernite",
        "global": "aggregats.scores.global"
      },
      "segmentation": {
        "prix_m2": "aggregats.segmentation.prix_m2",
        "surface": "aggregats.segmentation.surface",
        "age": "aggregats.segmentation.age"
      },
      "analyse_marche": {
        "z_score_prix_m2": "aggregats.analyse_marche.z_score_prix_m2",
        "positionnement_marche": "aggregats.analyse_marche.positionnement_marche",
        "ecart_pourcentage": "aggregats.analyse_marche.ecart_pourcentage",
        "prix_m2_marche_reference": "aggregats.analyse_marche.prix_m2_marche_reference"
      },
      "recommandations": {
        "prix": "aggregats.recommandations.prix",
        "marketing": "aggregats.recommandations.marketing",
        "amelioration": "aggregats.recommandations.amelioration",
        "ciblage": "aggregats.recommandations.ciblage"
      },
      "metadata_aggregation": {
        "date_aggregation": "aggregats.metadata_aggregation.date_aggregation",
        "algorithme_version": "aggregats.metadata_aggregation.algorithme_version",
        "marche_reference": {
          "prix_m2_moyen": "aggregats.metadata_aggregation.marche_reference.prix_m2_moyen",
          "nombre_biens_reference": "aggregats.metadata_aggregation.marche_reference.nombre_biens_reference"
        }
      }
    }
  },
  "validation_rules": {
    "required_fields": ["reference", "titre"],
    "date_fields": ["metadata.date_extraction", "aggregats.metadata_aggregation.date_aggregation"],
    "numeric_fields": [
      "prix.valeur", "prix.au_m2", "surface.valeur", "composition.pieces", 
      "composition.chambres", "batiment.annee_construction", "batiment.age_bien",
      "diagnostics.dpe.score", "diagnostics.ges.score", "metadata.score_qualite",
      "aggregats.performance.prix_m2", "aggregats.performance.loyer_estime_mensuel",
      "aggregats.performance.rendement_annuel_estime", "aggregats.scores.emplacement",
      "aggregats.scores.modernite", "aggregats.scores.global",
      "aggregats.analyse_marche.z_score_prix_m2", "aggregats.analyse_marche.ecart_pourcentage",
      "aggregats.analyse_marche.prix_m2_marche_reference",
      "aggregats.metadata_aggregation.marche_reference.prix_m2_moyen",
      "aggregats.metadata_aggregation.marche_reference.nombre_biens_reference"
    ],
    "boolean_fields": [
      "batiment.ascenseur", "copropriete.procedures_en_cours",
      "medias.has_video", "medias.has_visite_virtuelle", "medias.has_photo"
    ]
  },
  "indexes": {
    "unique": ["reference"],
    "searchable": [
      "localisation.ville", "localisation.code_postal", "composition.type_bien",
      "diagnostics.dpe.classe", "diagnostics.ges.classe"
    ],
    "range": [
      "prix.valeur", "surface.valeur", "batiment.annee_construction",
      "aggregats.performance.prix_m2", "metadata.score_qualite"
    ]
  }
}
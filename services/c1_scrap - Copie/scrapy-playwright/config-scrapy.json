{
  "site": {
    "name": "IAD France",
    "base_url": "https://www.iadfrance.fr",
    "search_url": "https://www.iadfrance.fr/annonces/vente",
    "wait_timeout": 10000,
    "navigation_delay": 2000
  },

  "search_form": {
    "transaction_type": {
      "options": {
        "acheter": {
          "css_selector": "label.flex-1:has-text('Acheter') input[type='radio']",
          "description": "Option Acheter"
        },
        "louer": {
          "css_selector": "label.flex-1:has-text('Louer') input[type='radio']",
          "description": "Option Louer"
        },
        "vendre": {
          "css_selector": "label.flex-1:has-text('Vendre') input[type='radio']",
          "description": "Option Vendre"
        }
      }
    },
    
    "type_bien": {
      "options": {
        "ancien": {
          "css_selector": "label:has-text('Ancien') input[type='radio']",
          "description": "Bien ancien"
        },
        "neuf": {
          "css_selector": "label:has-text('Neuf') input[type='radio']",
          "description": "Bien neuf"
        },
        "prestige": {
          "css_selector": "label:has-text('Prestige') input[type='radio']",
          "description": "Bien prestige"
        },
        "terrain": {
          "css_selector": "label:has-text('Terrain') input[type='radio']",
          "description": "Terrain"
        }
      }
    },
    
    "localisation": {
      "input_css": "input[placeholder='Ville, code postal…']",
      "suggestions_container": {
        "items_css": "div[role='listbox'] div[role='option']"
      }
    }
  },

  "search_results": {
    "articles": {
      "css_selector": "article.overflow-clip",
      "min_expected": 10
    },
    
    "pagination": {
      "next_page": {
        "css_selector": "a.iad-btn[href*='page=']:has-text('Suivant'), a[aria-label*='suivant']",
        "max_pages": 50
      }
    }
  },

  "article_list_data": {
    "reference": {
      "css_selector": "a[href*='/annonce/']",
      "attribute": "href",
      "regex": "/r(\\d+)"
    },
    
    "titre": {
      "css_selector": "a[href*='/annonce/'] h2, a[href*='/annonce/'] h3"
    },
    
    "lien": {
      "css_selector": "a[href*='/annonce/']",
      "attribute": "href"
    },
    
    "prix": {
      "css_selector": "div p:has-text('€'), p.text-lg:has-text('€'), strong.text-3xl"
    },
    
    "localisation": {
      "css_selector": "a[href*='/annonce/'] h2, a[href*='/annonce/'] h3",
      "regex": "à\\s+(.+)"
    },
    
    "image_url": {
      "css_selector": "img[src*='property']",
      "attribute": "src"
    },
    
    "caracteristiques": {
      "css_selector": "div.flex.justify-between ul li",
      "multiple": true
    },
    
    "surface": {
      "css_selector": "div.flex.justify-between ul li:has-text('m²')",
      "regex": "(\\d+)\\s*m²"
    },
    
    "pieces": {
      "css_selector": "div.flex.justify-between ul li:has-text('pièces')",
      "regex": "(\\d+)"
    },
    
    "chambres": {
      "css_selector": "div.flex.justify-between ul li:has-text('chambre')",
      "regex": "(\\d+)"
    },
    
    "badges": {
      "css_selector": "span.inline, [class*='badge']",
      "multiple": true
    }
  },

  "detail_page": {
    "wait_for": {
      "css_selector": "section.md\\:px-\\[4rem\\], div.lg\\:grid",
      "timeout": 10000
    },
    
    "data": {
      "reference": {
        "css_selector": "small.text-xs, p.pt-m",
        "regex": "(\\d+)"
      },
      
      "titre_complet": {
        "css_selector": "h1, h2.text-2xl, h2.text-3xl"
      },
      
      "prix_detaille": {
        "css_selector": "strong.text-3xl, p.pt-xs strong"
      },
      
      "prix_au_m2": {
        "css_selector": "dl.flex.gap-m dd:has-text('/ m²')"
      },
      
      "description": {
        "css_selector": "div.whitespace-pre-line"
      },
      
      "surface": {
        "css_selector": "li:has-text('m²')",
        "regex": "(\\d+)\\s*m²"
      },
      
      "pieces": {
        "css_selector": "li:has-text('pièces'), li:has-text('chambres')",
        "regex": "(\\d+)"
      },
      
      "localisation_complete": {
        "css_selector": "h2.group-\\[\\.is-prestige\\]\\:tracking-wider"
      },
      
      "caracteristiques_detaillees": {
        "css_selector": "ul.group-\\[\\.is-prestige\\]\\:grid li, ul.pb-xl li",
        "multiple": true
      },
      
      "annee_construction": {
        "css_selector": "li:has-text('Construit en')",
        "regex": "(\\d{4})"
      },
      
      "images": {
        "css_selector": "img[src*='property']",
        "multiple": true,
        "attribute": "src"
      },
      
      "nombre_photos": {
        "css_selector": "button.iad-btn span.font-semibold:has-text('photos')",
        "regex": "(\\d+)\\s*photos?"
      },

      "copropriete": {
        "nb_lots": {
          "css_selector": "dt:has-text('Nombre de lots') + dd"
        },
        "charges_previsionnelles": {
          "css_selector": "dt:has-text('Charges prévisionnelles') + dd"
        },
        "procedures": {
          "css_selector": "dt:has-text('Procédures') + dd"
        }
      },

      "conseiller": {
        "nom_complet": {
          "css_selector": "a.flex-col p.text-xl"
        },
        "telephone": {
          "css_selector": "button:has-text('+33') span",
          "regex": "(\\+33[\\d\\s]+)"
        },
        "lien": {
          "css_selector": "a.flex-col",
          "attribute": "href"
        },
        "photo": {
          "css_selector": "a.flex-col img.size-full",
          "attribute": "src"
        },
        "note": {
          "css_selector": "[class*='rating'], [class*='note']"
        },
        "nombre_avis": {
          "css_selector": ":has-text('avis')",
          "regex": "(\\d+)"
        }
      },

      "dpe": {
        "classe_active": {
          "css_selector": "div.group-\\[\\.is-prestige\\]\\:flex-col > div:nth-child(1) li.border-white span"
        },
        "consommation_energie": {
          "css_selector": ".border-epc-C span.text-base"
        }
      },

      "ges": {
        "classe_active": {
          "css_selector": "div.group-\\[\\.is-prestige\\]\\:flex-col > div:nth-child(2) li.border-white span"
        },
        "emissions": {
          "css_selector": ".border-ges-A span.text-base"
        }
      },

      "depenses_energie": {
        "min": {
          "css_selector": "div.text-sm:nth-child(3) > p:nth-child(1)",
          "regex": "(\\d+\\s*€)"
        },
        "max": {
          "css_selector": "div.text-sm:nth-child(3) > p:nth-child(2)",
          "regex": "(\\d+\\s*€)"
        }
      }
    }
  },

  "scraping_strategy": {
    "max_pages": 50,
    "max_details_per_page": 5,
    "delay_between_requests": 1000,
    "timeout_per_page": 30000,
    "retry_attempts": 3
  },

  "output": {
    "fields": [
      "reference",
      "titre",
      "titre_complet", 
      "prix",
      "prix_detaille",
      "prix_au_m2",
      "localisation",
      "localisation_complete",
      "surface",
      "pieces",
      "description",
      "caracteristiques_detaillees",
      "annee_construction",
      "images",
      "nombre_photos",
      "lien",
      "date_extraction",
      "dpe_classe_active", 
      "ges_classe_active",
      "depenses_energie_min",
      "depenses_energie_max",
      "copropriete_nb_lots",
      "copropriete_charges_previsionnelles", 
      "copropriete_procedures",
      "conseiller_nom_complet",
      "conseiller_telephone",
      "conseiller_lien",
      "conseiller_photo",
      "conseiller_note",
      "conseiller_nombre_avis"
    ],
    "timestamp_format": "iso"
  }
}